<header class="header">
  <div class="header-inner">
    <div class="logo">Paetzold Lab</div>

    <nav class="top-nav">
      <ul>
        <li><a id="nav-home"    href="/index.html">Home</a></li>
        <li><a id="nav-research" href="/research.html">Research</a></li>
        <li><a id="nav-team"    href="/team.html">Team</a></li>
        <li><a id="nav-join"    href="/join_us.html">Join Us</a></li>
      </ul>
    </nav>

    <div class="nav-right">
      <button class="search-btn" aria-label="Open search">üîç</button>
    </div>
  </div>

  <div class="progress-container">
    <div class="progress-bar" id="progress-bar"></div>
  </div>
</header>

<script>
document.addEventListener('DOMContentLoaded', () => {
  // --- Set active nav link ---
  const file = (location.pathname.split('/').pop() || 'index.html').toLowerCase();
  const map  = {
    'index.html'   : 'nav-home',
    'research.html': 'nav-research',
    'team.html'    : 'nav-team',
    'join_us.html' : 'nav-join',
    'contact.html' : 'nav-contact',
    'pi.html'      : 'nav-team'
  };
  const activeLink = document.getElementById(map[file]);
  if (activeLink) {
    activeLink.classList.add('active');
  }

  // --- Adjust links for GitHub Pages deployment ---
  const isGitHubPages = window.location.hostname.includes('github.io');
  
  if (isGitHubPages) {
    // Extract the repository name from the pathname, e.g., "/web/"
    const repoName = window.location.pathname.split('/')[1];
    const basePath = `/web/${repoName}/`;

    // Determine if the current page is in a subdirectory
    const pathSegments = window.location.pathname.split('/').filter(Boolean);
    const isSubpage = pathSegments.length > 2; // e.g., /web/team_members_subpage/file.html

    document.querySelectorAll('.top-nav a').forEach(link => {
      const originalHref = link.getAttribute('href');
      if (originalHref && !originalHref.startsWith('http')) {
        // For subpages, we need to navigate up to the repository root
        const newHref = isSubpage ? `..${basePath}${originalHref}` : `${basePath}${originalHref}`;
        link.setAttribute('href', newHref.replace('//', '/')); // Clean up double slashes
      }
    });
  }
});
</script>
