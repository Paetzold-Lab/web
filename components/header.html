<header class="header">
  <div class="header-inner">
    <div class="logo">Paetzold Lab</div>

    <nav class="top-nav">
      <ul>
        <li><a id="nav-home"    href="index.html">Home</a></li>
        <li><a id="nav-research" href="research.html">Research</a></li>
        <li><a id="nav-team"    href="team.html">Team</a></li>
        <li><a id="nav-join"    href="join_us.html">Join Us</a></li>
      </ul>
    </nav>

    <div class="nav-right">
      <button class="search-btn" aria-label="Open search">🔍</button>
    </div>
  </div>

  <div class="progress-container">
    <div class="progress-bar" id="progress-bar"></div>
  </div>
</header>

<script>
// Ensure header initialization runs even when this fragment is injected after DOMContentLoaded
(function initHeader(){
  function run(){
    // --- Set active nav link ---
    const file = (location.pathname.split('/').pop() || 'index.html').toLowerCase();
    const map  = {
      'index.html'   : 'nav-home',
      'research.html': 'nav-research',
      'team.html'    : 'nav-team',
      'join_us.html' : 'nav-join',
      'contact.html' : 'nav-contact',
      'pi.html'      : 'nav-team'
    };
    const activeLink = document.getElementById(map[file]);
    if (activeLink) activeLink.classList.add('active');

    // --- Adjust links when inside team member subpage directory ---
    const isInSubdirectory = window.location.pathname.includes('/team_members_subpage/');
    if (isInSubdirectory) {
      document.querySelectorAll('.top-nav a').forEach(link => {
        const href = link.getAttribute('href');
        if (!href) return;
        // Only modify relative (non-absolute + non-protocol) links
        if (href.startsWith('http') || href.startsWith('/') ) return;
        // Avoid double prefixing
        if (href.startsWith('../')) return;
        link.setAttribute('href', `../${href}`);
      });
    }
  }
  if (document.readyState === 'loading') {
    document.addEventListener('DOMContentLoaded', run, { once: true });
  } else {
    run();
  }
})();
</script>
